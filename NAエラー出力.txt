Sub ExtractNonNAData()
    Dim wsSource As Worksheet
    Dim wsDest As Worksheet
    Dim lastRow As Long
    Dim lastCol As Long
    Dim destRow As Long
    Dim i As Long, j As Long
    Dim includeRow As Boolean
    Dim rngToCopy As Range

    ' ソースとするシートを設定
    Set wsSource = ThisWorkbook.Sheets("Sheet1") ' データがあるシート名に変更してください

    ' ソースシートを表示状態にする
    wsSource.Visible = xlSheetVisible

    ' デスティネーションシートを作成または設定
    On Error Resume Next
    Set wsDest = ThisWorkbook.Sheets("NonNA_Data")
    If wsDest Is Nothing Then
        Set wsDest = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
        wsDest.Name = "NonNA_Data"
    End If
    On Error GoTo 0

    ' デスティネーションシートの以前のデータをクリア
    wsDest.Cells.Clear

    ' ソースシートの最終行と最終列を取得
    lastRow = wsSource.Cells(wsSource.Rows.Count, "A").End(xlUp).Row
    lastCol = wsSource.Cells(1, wsSource.Columns.Count).End(xlToLeft).Column

    ' ヘッダー行をソースからデスティネーションにコピー
    wsSource.Rows(1).Copy Destination:=wsDest.Rows(1)

    ' デスティネーション行カウンタの初期化
    destRow = 2

    ' ソースシートの各行をループ
    For i = 2 To lastRow ' 2行目から開始してヘッダー行をスキップ
        includeRow = True
        ' 各行のセルをチェックして#N/Aがあるか確認
        For j = 1 To lastCol
            If IsError(wsSource.Cells(i, j)) Then
                ' エラー値としての#N/Aを確認
                If WorksheetFunction.IsNA(wsSource.Cells(i, j)) Then
                    includeRow = False
                    Exit For
                End If
            Else
                ' テキストとしての#N/Aを確認
                If wsSource.Cells(i, j).Text = "#N/A" Then
                    includeRow = False
                    Exit For
                End If
            End If
        Next j
        ' #N/Aが見つからなければ、行を範囲に追加
        If includeRow Then
            If rngToCopy Is Nothing Then
                Set rngToCopy = wsSource.Rows(i)
            Else
                Set rngToCopy = Union(rngToCopy, wsSource.Rows(i))
            End If
        End If
    Next i

    ' まとめてコピー
    If Not rngToCopy Is Nothing Then
        rngToCopy.Copy Destination:=wsDest.Rows(destRow)
    End If

    ' デスティネーションシートの列を自動調整
    wsDest.Columns.AutoFit

    MsgBox "データが#N/Aのない状態で'NonNA_Data'シートに抽出されました。", vbInformation
End Sub
